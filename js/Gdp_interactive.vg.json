{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "params": [
    {
      "name": "min_gdp",
      "value": 0,
      "bind": {
        "input": "range",
        "min": 0,
        "max": 100000,
        "step": 1000,
        "name": "Minimum GDP per Capita (US$): "
      }
    }
  ],
  "vconcat": [
    {
      "width": 800,
      "height": 500,
      "title": "Global Economic Analysis: GDP per Capita vs Population",
      "data": {
        "url": "https://raw.githubusercontent.com/henryma0722/3179c2/main/data/merged_economic_data.csv"
      },
      "transform": [
        {
          "calculate": "datum.GDP_2022 / datum.POP_2022",
          "as": "GDP_per_capita"
        },
        {"filter": "datum.GDP_per_capita > min_gdp"},
        {
          "filter": "datum['Country Name'] == 'Malaysia' || datum['Country Name'] == 'Thailand' || datum['Country Name'] == 'Singapore' || datum['Country Name'] == 'Indonesia'  || datum['Country Name'] == 'Viet Nam' || datum['Country Name'] == 'Philippines' || datum['Country Name'] == 'Myanmar' || datum['Country Name'] == 'Cambodia' || datum['Country Name'] == 'Laos' || datum['Country Name'] == 'Brunei Darussalam'"
        },
        {"filter": "datum.GDP_2022 > 0 && datum.POP_2022 > 0"}
      ],
      "encoding": {
        "x": {
          "field": "POP_2022",
          "type": "quantitative",
          "title": "Population",
          "axis": {
            "format": ".0s",
            "values": [
              1000,
              10000,
              100000,
              1000000,
              10000000,
              100000000
            ]
          },
          "scale": {"type": "log"}
        },
        "y": {
          "field": "GDP_per_capita",
          "type": "quantitative",
          "title": "GDP per Capita (US$)",
          "axis": {
            "format": "$,.0f",
            "values": [1000, 10000, 100000, 1000000]
          },
          "scale": {"type": "log"}
        }
      },
      "layer": [
        {
          "mark": "circle",
          "encoding": {
            "size": {
              "field": "POP_2022",
              "type": "quantitative",
              "title": "Population",
              "scale": {"type": "log", "range": [50, 2000]},
              "legend": {
                "format": ".0s",
                "values": [
                  1000000,
                  10000000,
                  100000000
                ]
                
              }
            },
            "color": {
              "field": "Country Name",
              "type": "nominal",
              "title": "Country"
              
            },
            "opacity": {"value": 0.6},
            "tooltip": [
              {"field": "Country Name", "type": "nominal", "title": "Country"},
              {"field": "Continent", "type": "nominal", "title": "Continent"},
              {
                "field": "POP_2022",
                "type": "quantitative",
                "title": "Population",
                "format": ","
              },
              {
                "field": "GDP_2022",
                "type": "quantitative",
                "title": "Total GDP",
                "format": "$,.0f"
              },
              {
                "field": "GDP_per_capita",
                "type": "quantitative",
                "title": "GDP per Capita",
                "format": "$,.0f"
              }
            ]
          }
        }
      ]
    }
  ],
  "config": {}
}
